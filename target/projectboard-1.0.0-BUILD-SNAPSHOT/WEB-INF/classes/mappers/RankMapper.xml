<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="RankMapper">
	<!-- 랭킹 화면에서 뿌려줄 작업들 -->
	<select id = "RankingList" resultType = "com.wg.dto.RiotDto.RankDto">
		<![CDATA[
			SELECT rnum rnum, userIcon, summonerId, rating, winRate, win, lose
			FROM (
			    SELECT 
			        icon_url AS userIcon, 
			        summoner_id AS summonerId, 
			        league_points AS rating, 
			        winrate AS winRate, 
			        win win, 
			        lose lose, 
			        ROW_NUMBER() OVER (ORDER BY league_points DESC) AS rnum
			    FROM summoner_info si
			    INNER JOIN icons i ON si.summoner_icon = i.icon_id
			    WHERE icon_url IS NOT NULL 
			      AND summoner_id IS NOT NULL
			      AND league_points IS NOT NULL 
			      AND winrate IS NOT NULL
			      AND win IS NOT NULL 
			      AND lose IS NOT NULL
			) b
			WHERE rnum BETWEEN #{rnum1} AND #{rnum2}
		]]>
	</select>
</mapper>